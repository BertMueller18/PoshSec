

function Find-SecADS{
<#
.Synopsis
  
.PARAMETER Path
  Path to check for rogue Alternate Data Streams (ADS).  

.EXAMPLE
  C:\> Find-SecADS C:\Windows\System32

#>
[CmdletBinding()]
param(
[parameter(Mandatory=$true)]
[String] $path 
)

Get-ChildItem $path -Recurse | ForEach-Object {
  $item = $_.fullname
  if (Test-Path $item -PathType Leaf){
    if ($item -match ".*\.url$"){
	Get-Item $item -Stream * | Where-Object {
     $_.Stream -ne ':$DATA' -and
	 $_.Stream -ne 'Zone.Identifier' -and
	 $_.Stream -ne 'favicon'
  
     } 
	}
	else{
     Get-Item $item -Stream * | Where-Object {
     $_.Stream -ne ':$DATA' -and
	 $_.Stream -ne 'Zone.Identifier'
  
     } 
	}
   
  }

 }

}
